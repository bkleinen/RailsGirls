<% provide(:title, 'Listing registrations') %>
<h1>Listing Registrations</h1>
<div id="list_options">
  <%= form_tag(registrations_path, :method => :get) do %>
    <dl>
      <dt>Workshop</dt>
      <dd>
        <%= select_tag'workshop', options_for_select(@list_options[:workshop], @previously_selected_workshop)%>
      </dd>
      <dt>Form Type</dt>
      <dd>
        <%= select_tag'form_type', options_for_select(@list_options[:form_type], @previously_selected_type)%>
      </dd>
    </dl>
  <% end %>
</div>

<div id="list_registrations">
  <%= form_tag "/registrations/accept_registrations" do %>
    <table>
      <thead>
        <tr>
          <% if (@participant_registrations.first != nil) && (!@participant_structure.blank?)%>
            <% @participant_structure.each do |element| %>
              <td><strong> <%= element['caption']%> </strong></td>
            <% end %>
          <% end %>
        <td><strong>Accept</strong></td>
        </tr>
      </thead>
      <tbody>
        <% @participant_registrations.each do |registration| %>
          <tr>
            <% @participant_structure.each do |element| %>
              <td><%= registration["attributes"][element["name"]] %></td>
            <% end %>
            <%=hidden_field_tag registration["id"], '0'%>
            <td><%= check_box_tag registration["id"], '1', Registration.find(registration["id"]).accepted%></td>
            <td><%= link_to 'Show', registration_path(registration["id"]) %></td>
            <td><%= link_to 'Edit', edit_registration_path(registration["id"]) %></td>
            <td><%= link_to 'Destroy', registration_path(registration["id"]), method: :delete, data: { confirm: 'Are you sure?' } %></td>
          </tr>
        <% end %>
      </tbody>
    </table>
    <%
    params.each do |key, value| %>
      <%=hidden_field_tag key, value %>
    <% end %>
    <table>
      <thead>
        <tr>
          <% if (@coach_registrations.first != nil) && (!@coach_structure.blank?)%>
            <% @coach_structure.each do |element| %>
              <td><strong> <%= element['caption']%> </strong></td>
            <% end %>
          <% end %>
        </tr>
      </thead>
      <tbody>
        <% @coach_registrations.each do |registration| %>
          <tr>
            <% @coach_structure.each do |element| %>
              <td><%= registration["attributes"][element["name"]] %></td>
            <% end %>

            <td><%= link_to 'Show', registration_path(registration["id"]) %></td>
            <td><%= link_to 'Edit', edit_registration_path(registration["id"]) %></td>
            <td><%= link_to 'Destroy', registration_path(registration["id"]), method: :delete, data: { confirm: 'Are you sure?' } %></td>
          </tr>
        <% end %>
      </tbody>
    </table>
  <% end %>
</div>
<%- params[:format] = "csv"
-%>
<%= link_to "Export CSV", registrations_path(params) %> |
<%- params[:format] = "xls"
-%>
<%= link_to "Export Excel", registrations_path(params) %>

